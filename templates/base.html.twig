<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
       	<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Galada&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
	    {% block stylesheets %}
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
	<script>
document.addEventListener('click', async (e) => {
	const btn = e.target.closest('.js-add-to-cart');
	if (!btn) return;

	e.preventDefault();

	const url = btn.dataset.url;
	if (!url) return;

	btn.disabled = true;

	try {
		const res = await fetch(url, {
			method: 'POST',
			headers: {
				'X-Requested-With': 'XMLHttpRequest',
				'Accept': 'application/json',
				'Content-Type': 'application/x-www-form-urlencoded'
			},
			credentials: 'same-origin',
			body: new URLSearchParams({ qty: '1' }).toString()
		});

		const data = await res.json();

		if (data && data.ok) {
			const badge = document.getElementById('cart-badge');
			if (badge) {
				const count = parseInt(data.count || 0, 10);
				badge.textContent = String(count);
				badge.classList.toggle('d-none', count <= 0);
			}
		}
	} catch (err) {
		console.error(err);
	} finally {
		btn.disabled = false;
	}
});
</script>
    <body class="{% block body_class %}{% endblock %}" data-controller="wishlist">
		{{ include('navbar.html.twig', { cart_count: cart_count|default(0) }) }}
        {% block body %}{% endblock %}
    </body>
</html>
