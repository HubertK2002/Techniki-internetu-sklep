{# templates/product/product_card.html.twig #}

<div class="card h-100 shadow-sm">
	{% if product.Image %}
		<img src="{{ asset('products/' ~ product.Image) }}" alt="{{ product.Name }}">
	{% else %}
		<div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height: 180px;">
			<span class="text-muted">Brak zdjęcia</span>
		</div>
	{% endif %}

	<div class="card-body d-flex flex-column">
		<h5 class="card-title mb-2">{{ product.Name }}</h5>

		{% if product.Description %}
			<p class="card-text text-muted small mb-3">
				{{ product.Description|striptags|u.truncate(120, '…') }}
			</p>
		{% endif %}

		<div class="mt-auto d-flex justify-content-between align-items-center">
			<div class="fw-semibold">
				{{ product.Price|number_format(2, ',', ' ') }} zł
			</div>

			{% if product.Stock is not null %}
				{% if product.Stock > 0 %}
					<span class="badge text-bg-success">Dostępny: {{ product.Stock }}</span>
				{% else %}
					<span class="badge text-bg-danger">Brak</span>
				{% endif %}
			{% endif %}
		</div>

		<div class="d-flex gap-2 mt-2">
			<button
				type="button"
				class="btn btn-sm btn-primary js-add-to-cart flex-grow-1"
				data-url="{{ path('cart_add', { id: product.id }) }}"
			>
				Dodaj do koszyka
			</button>

			{% if app.user %}
				<form method="post" action="{{ path('wishlist_add', { id: product.id }) }}" class="m-0">
					<input type="hidden" name="_token" value="{{ csrf_token('wishlist_add_' ~ product.id) }}">
					<button type="submit" class="btn btn-sm btn-outline-danger">Serce</button>
				</form>
			{% else %}
				<a href="{{ path('app_login') }}" class="btn btn-sm btn-outline-secondary">Serce</a>
			{% endif %}
		</div>
	</div>
</div>
