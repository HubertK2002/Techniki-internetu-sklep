{% extends 'base.html.twig' %}

{% block title %}Zamówienie #{{ order.id }}{% endblock %}

{% block body %}
<div class="container py-4">
	<h1 class="mb-3">Zamówienie #{{ order.id }}</h1>

	<div class="mb-3 text-muted">
		Status: <strong>{{ order.Status }}</strong>
	</div>

	{% set cart = order.Cart %}
	{% if cart is null or cart.Items|length == 0 %}
		<div class="alert alert-secondary">Brak pozycji w zamówieniu.</div>
	{% else %}
		<table class="table align-middle">
			<thead>
				<tr>
					<th>Produkt</th>
					<th class="text-end">Cena</th>
					<th class="text-end">Ilość</th>
					<th class="text-end">Suma</th>
				</tr>
			</thead>
			<tbody>
				{% set total = 0 %}
				{% for item in cart.Items %}
					{% set p = item.Product %}
					{% set unit = p ? p.Price : 0 %}
					{% set line = unit * item.Quantity %}
					{% set total = total + line %}

					<tr>
						<td>{{ p ? p.Name : 'Produkt usunięty' }}</td>
						<td class="text-end">{{ unit|number_format(2, ',', ' ') }} zł</td>
						<td class="text-end">{{ item.Quantity }}</td>
						<td class="text-end">{{ line|number_format(2, ',', ' ') }} zł</td>
					</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<th colspan="3" class="text-end">Razem</th>
					<th class="text-end">{{ total|number_format(2, ',', ' ') }} zł</th>
				</tr>
			</tfoot>
		</table>
		{{ include('order/checkout_steps.html.twig', { order: order }) }}
	{% endif %}

	<a class="btn btn-outline-primary" href="{{ path('product_index') }}">Wróć do produktów</a>
</div>
{% endblock %}
